<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MD Lambda View</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table, th, td {
            border: 1px solid black;
        }

        th, td {
            padding: 8px;
            text-align: left;
        }

        .data-container {
            margin: 10px 0;
        }

        button {
            margin: 10px 5px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <h1>MD Lambda View</h1>

    <div class="data-container">
        <div>Lambda Value: <span id="lambdaValue">--</span></div>
        <div>Sensor Temperature (°C): <span id="tempValue">--</span></div>
        <div>Engine RPM (1/min): <span id="rpmValue">--</span></div>
        <div>Throttle Position (%): <span id="throttleValue">--</span></div>
        <div>Voltage (V): <span id="voltageValue">--</span></div>
    </div>

    <button id="viewStoredData">View Stored Data</button>
    <button id="selectAllBtn">Mark all Entries</button>

    <!-- Tabelle -->
    <div id="dataTable" style="margin-top: 20px; display: none;">
        <h2>Stored Data</h2>
        <table>
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Lambda</th>
                    <th>Temp</th>
                    <th>Volt</th>
                    <th>RPM</th>
                    <th>Throttle</th>
                </tr>
            </thead>
            <tbody id="dataTableBody"></tbody>
        </table>
    </div>

    <script>
        const LSU_4_9_Temperature_Array = [
            80, 78, 77, 75, 74, 73, 71, 70, 68, 67, 65, 64, 63, 61, 60, 59, 58, 56, 55, 54, 52, 51, 50, 49, 48, 46,
            45, 44, 43, 42, 41, 40, 39, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19,
            18, 18, 17, 16, 15, 14, 13, 12, 11, 11, 10, 9, 8, 7, 6, 5, 5, 4, 3, 2, 1, 1, 0
        ];

        // Funktion zum Speichern von Daten
        function saveData(afr, temp, volt, rpm, throttle) {
            const storedData = JSON.parse(localStorage.getItem('sensorData')) || [];
            storedData.push({
                time: new Date().toISOString(),
                afr: afr.toFixed(2),
                temp,
                volt: volt.toFixed(1),
                rpm,
                throttle: throttle.toFixed(1)
            });
            localStorage.setItem('sensorData', JSON.stringify(storedData));
        }

        // Test-Daten zum Debuggen (entfernen, wenn Gerätedaten kommen)
        saveData(1.03, 750, 14.8, 3000, 20.5);
        saveData(1.15, 760, 13.7, 3200, 22.0);

        // Daten anzeigen
        document.getElementById('viewStoredData').addEventListener('click', () => {
            const storedData = JSON.parse(localStorage.getItem('sensorData')) || [];
            const tbody = document.getElementById('dataTableBody');
            tbody.innerHTML = '';

            if (storedData.length === 0) {
                alert('No data stored yet!');
                return;
            }

            storedData.forEach(entry => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${entry.time}</td>
                    <td>${entry.afr.replace('.', ',')}</td>
                    <td>${entry.temp}</td>
                    <td>${entry.volt.replace('.', ',')}</td>
                    <td>${entry.rpm}</td>
                    <td>${entry.throttle.replace('.', ',')}</td>
                `;
                tbody.appendChild(row);
            });

            document.getElementById('dataTable').style.display = 'block';
        });

        // Tabelle markieren
        document.getElementById('selectAllBtn').addEventListener('click', () => {
            const range = document.createRange();
            const table = document.querySelector('#dataTable table');
            if (table) {
                range.selectNodeContents(table);
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
            }
        });
    </script>
</body>
</html>

